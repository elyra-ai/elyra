{"version":3,"file":"lib_index_js.8bda0aafc3d4596efd43.js","mappings":"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","sources":["webpack://@elyra/script-debugger-extension/./src/index.ts"],"sourcesContent":["/*\r\n * Copyright 2018-2025 Elyra Authors\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n\r\nimport { ScriptEditor } from '@elyra/script-editor';\r\nimport {\r\n  ILabShell,\r\n  JupyterFrontEnd,\r\n  JupyterFrontEndPlugin\r\n} from '@jupyterlab/application';\r\nimport { Debugger, IDebugger } from '@jupyterlab/debugger';\r\nimport { IEditorTracker } from '@jupyterlab/fileeditor';\r\nimport { KernelManager, Session, SessionManager } from '@jupyterlab/services';\r\nimport { Widget } from '@lumino/widgets';\r\n\r\n/**\r\n * Debugger plugin.\r\n * Adapted from JupyterLab debugger extension.\r\n * A plugin that provides visual debugging support for script editors.\r\n */\r\nconst scriptEditorDebuggerExtension: JupyterFrontEndPlugin<void> = {\r\n  id: 'elyra-script-debugger',\r\n  autoStart: true,\r\n  requires: [IDebugger, IEditorTracker],\r\n  optional: [ILabShell],\r\n  activate: (\r\n    app: JupyterFrontEnd,\r\n    debug: IDebugger,\r\n    editorTracker: IEditorTracker,\r\n    labShell: ILabShell | null\r\n  ) => {\r\n    console.log('Elyra - script-debugger extension is activated!');\r\n\r\n    const handler = new Debugger.Handler({\r\n      type: 'file',\r\n      shell: app.shell,\r\n      service: debug\r\n    });\r\n\r\n    const activeSessions: { [id: string]: Session.ISessionConnection } = {};\r\n    const kernelManager = new KernelManager();\r\n    const sessionManager = new SessionManager({\r\n      kernelManager: kernelManager\r\n    });\r\n\r\n    const updateDebugger = async (widget: ScriptEditor): Promise<void> => {\r\n      const widgetInFocus = app.shell.currentWidget;\r\n      if (widget !== widgetInFocus) {\r\n        return;\r\n      }\r\n\r\n      const kernelSelection = (widget as ScriptEditor).kernelSelection;\r\n\r\n      const sessions = app.serviceManager.sessions;\r\n      try {\r\n        const path = widget.context.path;\r\n        let sessionModel = await sessions.findByPath(path);\r\n        if (!sessionModel) {\r\n          // Start a kernel session for the selected kernel supporting debug\r\n          const sessionConnection = await startSession(kernelSelection, path);\r\n          sessionModel = await sessions.findByPath(path);\r\n          if (sessionConnection && sessionModel) {\r\n            activeSessions[sessionModel.id] = sessionConnection;\r\n          }\r\n        }\r\n        if (sessionModel) {\r\n          let sessionConnection: Session.ISessionConnection | null =\r\n            activeSessions[sessionModel.id];\r\n          if (!sessionConnection) {\r\n            // Use `connectTo` only if the session does not exist.\r\n            // `connectTo` sends a kernel_info_request on the shell\r\n            // channel, which blocks the debug session restore when waiting\r\n            // for the kernel to be ready\r\n            sessionConnection = sessions.connectTo({ model: sessionModel });\r\n            activeSessions[sessionModel.id] = sessionConnection;\r\n          }\r\n\r\n          await updateKernel(sessionConnection, kernelSelection);\r\n\r\n          // Temporary solution to give enough time for the handler to update the UI on page reload.\r\n          setTimeout(async () => {\r\n            await handler.update(widget, sessionConnection);\r\n            app.commands.notifyCommandChanged();\r\n          }, 500);\r\n        }\r\n      } catch (error) {\r\n        console.warn(\r\n          'Exception: session connection = ' + JSON.stringify(error)\r\n        );\r\n      }\r\n    };\r\n\r\n    // Use a weakmap to track the callback function used by signal listeners\r\n    // The object is cleared by garbabe collector when no longer in use avoiding memory leaks\r\n    // Key: ScriptEditor widget\r\n    // Value: instance of updateDebugger function\r\n    const callbackControl = new WeakMap<ScriptEditor, () => Promise<void>>();\r\n\r\n    const update = async (widget: Widget | null): Promise<void> => {\r\n      if (widget instanceof ScriptEditor) {\r\n        let callbackFn = callbackControl.get(widget);\r\n        if (!callbackFn) {\r\n          callbackFn = (): Promise<void> => updateDebugger(widget);\r\n          callbackControl.set(widget, callbackFn);\r\n        }\r\n        updateDebugger(widget);\r\n\r\n        // Listen to possible kernel selection changes\r\n        widget.kernelSelectionChanged.disconnect(callbackFn);\r\n        widget.kernelSelectionChanged.connect(callbackFn);\r\n      }\r\n    };\r\n\r\n    if (labShell) {\r\n      // Listen to main area's current focus changes.\r\n      labShell.currentChanged.connect((_, widget) => {\r\n        return update(widget.newValue);\r\n      });\r\n    }\r\n\r\n    if (editorTracker) {\r\n      // Listen to script editor's current instance changes.\r\n      editorTracker.currentChanged.connect((_, widget) => {\r\n        return update(widget);\r\n      });\r\n    }\r\n\r\n    const startSession = async (\r\n      kernelSelection: string,\r\n      path: string\r\n    ): Promise<Session.ISessionConnection | null> => {\r\n      const options: Session.ISessionOptions = {\r\n        kernel: {\r\n          name: kernelSelection\r\n        },\r\n        path: path,\r\n        type: 'file',\r\n        name: path\r\n      };\r\n      let sessionConnection: Session.ISessionConnection | null = null;\r\n      try {\r\n        if (kernelSelection) {\r\n          sessionConnection = await sessionManager.startNew(options);\r\n          sessionConnection.setPath(path);\r\n          console.log(`Kernel session started for ${kernelSelection} kernel`);\r\n        }\r\n      } catch (error) {\r\n        console.warn('Exception: start session = ' + JSON.stringify(error));\r\n      }\r\n      return sessionConnection;\r\n    };\r\n\r\n    const updateKernel = async (\r\n      sessionConnection: Session.ISessionConnection,\r\n      kernelSelection: string\r\n    ): Promise<void> => {\r\n      try {\r\n        const prev = sessionConnection.kernel?.name;\r\n        if (kernelSelection && prev !== kernelSelection) {\r\n          await sessionConnection.changeKernel({ name: kernelSelection });\r\n          console.log(`Kernel change from ${prev} to ${kernelSelection}`);\r\n        }\r\n      } catch (error) {\r\n        console.warn('Exception: change kernel = ' + JSON.stringify(error));\r\n      }\r\n    };\r\n  }\r\n};\r\n\r\nexport default scriptEditorDebuggerExtension;\r\n"],"names":[],"sourceRoot":""}